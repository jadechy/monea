import{_ as G}from"./Bxrf48Gc.js";import{_ as O}from"./BKaoRVz1.js";import A from"./CvBWs6Qs.js";import{e as M,c,o as n,b as m,u as e,P as E,r as N,y as H,s as T,k as J,J as P,H as U,a as p,l as V,w as k,F as z,f as W,n as j,t as q}from"./EKjwmu4X.js";import{g as K}from"./8G3UIhLy.js";import{u as Q}from"./BlGWc5vv.js";import X from"./DWbfJTPH.js";import"./B9gn4CE_.js";import{h as Y}from"./88yLcmfY.js";import{N as Z}from"./BAVHM7yr.js";import{u as ee}from"./9cFPbx9-.js";import{u as te}from"./CCi297vb.js";import{a as oe,g as re}from"./CPAmBVur.js";import se from"./C2Bx1OkL.js";import ae from"./CxiRr9we.js";import ie from"./CmySksWD.js";import"./795X7oyD.js";import"./DiAjKAwH.js";import"./Ct_YkEU2.js";import"./hquyow-S.js";import"./BvNSvTB1.js";import"./BmOpcpC3.js";import"./Dqon5DMq.js";import"./jc0MLXVe.js";import"./ZhWAdK_X.js";import"./qSTTT7Tw.js";import"./CLs7nh7g.js";import"./DT05_xfd.js";import"./BuP7n0Ls.js";import"./GmmX6_XI.js";import"./CKS-U1Rg.js";import"./DW5wOTjr.js";import"./vqib8As9.js";import"./yczKQwiS.js";import"./CikSr-ZV.js";import"./zcTZZBfU.js";import"./TWS-w1EI.js";import"./CizPGRaz.js";const le={class:"w-full flex justify-center h-24"},ue=M({__name:"LoadingComponent",setup(D){return(b,f)=>(n(),c("div",le,[m(e(A),{"aria-label":"Loading"})]))}}),ne={class:"w-full flex justify-center"},me={class:"grid gap-2 grid-cols-2 md:grid-cols-3 mt-6 w-full"},pe={class:"flex items-center gap-2"},Qe=M({__name:"edit",setup(D){var $,y,x,h,S;const b=E(),{group_id:f}=b.params,s=N(null);H(()=>{s.value=new Date});const{group:a}=T(J()),g=N(null),{categories:l}=te();ee({title:`Modifier le budget du groupe ${($=a.value)==null?void 0:$.name}`,description:`Ajustez les montants par catégorie, modifiez les plafonds mensuels et gérez les priorités budgétaires du groupe ${(y=a.value)==null?void 0:y.name}.`,ogTitle:`Édition du budget - ${(x=a.value)==null?void 0:x.name}`,ogDescription:`Modifiez le budget partagé du groupe ${(h=a.value)==null?void 0:h.name} : ajustez les catégories, maîtrisez vos dépenses et anticipez les imprévus.`,image:((S=a.value)==null?void 0:S.picture)??void 0});const{refetchBudget:I,postBudgetsMutation:L,budgetList:v}=Q(s),w=()=>!v.value||!l.value?{}:l.value.reduce((t,o)=>{var u;return t[o.id]=((u=v.value.find(r=>Number(r.category.id)===Number(o.id)))==null?void 0:u.amount)??0,t},{});P(s,async()=>{if(l.value&&(await I(),g.value)){const t=w();g.value.setValues(t)}});const R=t=>{if(!t.valid||!l.value||!s.value)return;const o=Object.entries(t.states).map(r=>{var d;return{amount:Number(r[1]&&((d=r[1])!=null&&d.value)?r[1].value:0),monthStart:oe(re(s.value)),categoryId:Number(r[0])}}),u={groupId:Number(f),budgets:o};L.mutate(u)},F=U(()=>w());return(t,o)=>{var B;const u=G,r=O,d=ue;return n(),c(z,null,[m(u,{label:"Edition des Budgets",color:(B=e(a))==null?void 0:B.color,to:`/groups/${e(f)}/budget`},null,8,["color","to"]),p("div",ne,[m(e(se),{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=_=>s.value=_),view:"month","date-format":"mm/yy",class:"w-64 mt-3","input-class":"text-center"},null,8,["modelValue"])]),e(v)&&e(l)?(n(),V(e(X),{key:0,ref_key:"formRef",ref:g,"initial-values":F.value,resolver:e(Y)(e(Z)),class:"flex justify-center flex-col items-center gap-10",onSubmit:R},{default:k(_=>{var C;return[p("section",me,[(n(!0),c(z,null,W(e(l),i=>(n(),c("div",{key:i.id,class:j(["flex justify-between items-center rounded-full px-4 py-3",`bg-${i.color}-50 text-${i.color}-800`])},[p("p",null,q(i.label!=="default"?i.label:"Autres"),1),p("div",pe,[m(r,{form:_,name:String(i.id),placeholder:"Budget",class:"w-24"},{default:k(()=>[m(e(ae),{name:String(i.id),fluid:""},null,8,["name"])]),_:2},1032,["form","name"]),o[1]||(o[1]=p("p",{class:"text-2xl"},"€",-1))])],2))),128))]),m(e(ie),{class:j([[("getGroupColor"in t?t.getGroupColor:e(K))({color:(C=e(a))==null?void 0:C.color})],"w-64"]),type:"submit",label:"Sauvergarde les budgets"},null,8,["class"])]}),_:1},8,["initial-values","resolver"])):(n(),V(d,{key:1}))],64)}}});export{Qe as default};
