const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DigIgAcp.js","./Cpj98o6Y.js","./CshrRwMP.js"])))=>i.map(i=>d[i]);
import Z from"./De1U4e1x.js";import G from"./BA-yyycA.js";import ee from"./Dp-9aMN4.js";import te from"./0ZMUp3e9.js";import oe from"./xn0_V1pL.js";import{e as N,G as le,H as re,k as T,w as h,o as _,a as v,c as x,f as U,F,d as H,t as R,l as D,b as f,I as J,J as I,r as ae,u as b}from"./CNJ8szB1.js";import ne from"./DbTHBJq2.js";import se from"./IsA_81Dl.js";import ie from"./IPBdOQN9.js";import ue from"./BcoeO2u8.js";import me from"./Ctr8eHZj.js";import j from"./CkxTJ8nP.js";import{u as ce}from"./CBUAFA2r.js";import"./BHZM8757.js";import"./BYYiIYFi.js";import"./DR_DedFW.js";import"./AG8Trlfw.js";import"./ZhWAdK_X.js";import"./Ddp992_D.js";import"./BEmseXU-.js";import"./jc0MLXVe.js";import"./DJvYhkZy.js";import"./FcIMTHEa.js";import"./WiZy95Ex.js";import"./Do1UB513.js";import"./C-cRNBNc.js";import"./CfN_dZC2.js";import"./DTAV0SeA.js";import"./RzJ5KDvm.js";import"./CLs7nh7g.js";import"./BqzB17NX.js";import"./DPrnkg-K.js";import"./DkIHtb0h.js";import"./DoGDA1Lb.js";import"./C8j-7XxP.js";const pe={class:"flex flex-col gap-14 sm:gap-8 mt-3"},de={class:"flex gap-6"},fe=["for"],ge={class:"flex gap-3 items-center"},ve=["for"],_e=N({__name:"NewEnter",props:le({category:{}},{form:{},formModifiers:{}}),emits:["update:form"],setup(w){const e=re(w,"form");return(a,m)=>{const p=oe,g=te,o=ee,i=G,c=Z;return _(),T(c,null,{title:h(()=>[H(R(a.category==="exits"?"Sortie":"Entrée")+" d'argent",1)]),content:h(()=>{var t;return[v("div",pe,[(_(!0),x(F,null,U((t=e.value)==null?void 0:t[a.category],(r,n)=>{var $;return _(),x("div",{key:n,class:"flex gap-8 justify-between sm:flex-row flex-col"},[v("div",de,[f(g,{class:"w-40"},{default:h(()=>[f(p,{modelValue:r.name,"onUpdate:modelValue":u=>r.name=u,fluid:""},null,8,["modelValue","onUpdate:modelValue"]),v("label",{for:`${r}-${n}-name`},"Nom",8,fe)]),_:2},1024),v("div",ge,[f(g,{class:"w-22"},{default:h(()=>[f(o,{modelValue:r.value,"onUpdate:modelValue":u=>r.value=u,fluid:""},null,8,["modelValue","onUpdate:modelValue"]),v("label",{for:`${r}-${n}-value`},"Montant",8,ve)]),_:2},1024),m[1]||(m[1]=v("p",{class:"font-bold text-3xl"},"€",-1))])]),($=e.value)!=null&&$[a.category]&&n===e.value[a.category].length-1?(_(),T(i,{key:0,class:"h-fit",disabled:!(r.name&&r.name.trim()!==""&&r.value!==null),icon:"pi pi-plus","aria-label":`add ${a.category}`,onClick:m[0]||(m[0]=u=>{var d;return(d=e.value)==null?void 0:d[a.category].push({name:null,value:null})})},null,8,["disabled","aria-label"])):D("",!0)])}),128))])]}),_:1})}}}),ye={class:"flex gap-2 items-center"},we=N({__name:"RowSavings",props:{form:{},category:{}},setup(w){return(e,a)=>{const m=ne;return _(!0),x(F,null,U(e.form[e.category].filter(p=>p.name&&p.value!=null),(p,g)=>(_(),x("div",{key:e.category+"-"+g,class:"item rounded shadow-sm h-fit"},[v("div",ye,[f(m,{severity:e.category==="enters"?"success":"danger",value:e.category==="enters"?"Entrée":"Sortie"},null,8,["severity","value"]),v("p",null,R(p.name),1)]),v("p",null,R(p.value)+" €",1)]))),128)}}}),$e=({form:w})=>({months:J(()=>{const a=w.value.start,m=w.value.end;if(!a||!m)return[];const p=[],g=new Date(a.getFullYear(),a.getMonth(),1),o=new Date(m.getFullYear(),m.getMonth(),1);for(;g<=o;)p.push(g.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})),g.setMonth(g.getMonth()+1);return p})}),he=({form:w,months:e,savings:a})=>{const m=({category:o})=>w[o].filter(c=>c.name&&c.value!=null).map(c=>{const t={Type:o==="enters"?"Entrée":"Sortie",Nom:c.name};return e.forEach(r=>{t[r]=c.value}),t}),p=({worksheet:o,enterEndRow:i,summaryStartRow:c,categoryItems:t,categoryType:r})=>{const n="C",$=`${n}2:${n}${i}`,u=o.getRow(c);u.getCell(1).value=`Total ${r==="enters"?"Entrées":"Sorties"}`,u.getCell(3).value={formula:`SUM(${$})`,result:t.reduce((d,y)=>d+y[e[0]],0)}};return{exportFormToExcel:async()=>{try{const[o,i]=await Promise.all([I(()=>import("./DigIgAcp.js").then(l=>l.e),__vite__mapDeps([0,1]),import.meta.url),I(()=>import("./CshrRwMP.js").then(l=>l.F),__vite__mapDeps([2,1]),import.meta.url)]),c=new o.default.Workbook,t=c.addWorksheet("Budget");t.columns=[{header:"Type",key:"Type",width:15},{header:"Nom",key:"Nom",width:30},...e.map(l=>({header:l,key:l,width:18}))];const r=m({category:"enters"}),n=m({category:"exits"}),$=[...r,...n];t.addRows($);const u=1+r.length,d=1+r.length+n.length,y=d+1,B={Type:"Total",Nom:"Épargne Cumulative"};e.forEach((l,s)=>{const C=String.fromCharCode(67+s),A=`${C}2:${C}${u}`,P=`${C}${u+1}:${C}${d}`;let k,M;if(s===0)k=`SUM(${A})-SUM(${P})`,M=a[s];else{const X=String.fromCharCode(67+s-1);k=`SUM(${A})-SUM(${P})+${X}${y}`,M=a[s]+(a[s-1]||0)}B[l]={formula:k,result:M}}),t.addRow(B),t.addRow([]);const E=y+2;p({worksheet:t,enterEndRow:u,summaryStartRow:E,categoryItems:r,categoryType:"enters"}),p({worksheet:t,enterEndRow:u+1,summaryStartRow:E+1,categoryItems:n,categoryType:"exits"});const S="C",O=`${S}2:${S}${u}`,W=`${S}${u+1}:${S}${d}`,L=t.getRow(E+2);L.getCell(1).value="Épargne Mensuelle",L.getCell(3).value={formula:`SUM(${O})-SUM(${W})`,result:a[0]};const V=t.getRow(1);V.font={bold:!0,size:12},V.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD3D3D3"}},V.alignment={horizontal:"center",vertical:"middle"};for(let l=2;l<=u;l++){const s=t.getRow(l);s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE8F5E8"}},s.getCell(1).font={bold:!0}}for(let l=u+1;l<=d;l++){const s=t.getRow(l);s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFCE8E8"}},s.getCell(1).font={bold:!0}}const z=t.getRow(y);z.font={bold:!0,size:12},z.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFF2CC"}};for(let l=E;l<=E+2;l++){const s=t.getRow(l);s.getCell(1).font={bold:!0},s.getCell(2).font={bold:!0}}const Y=2+e.length,q=E+2;for(let l=2;l<=q;l++)for(let s=3;s<=Y;s++){const C=t.getCell(l,s);C.numFmt="#,##0.00",C.alignment={horizontal:"right"}}const K=await c.xlsx.writeBuffer(),Q=new Blob([K],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});i.saveAs(Q,"budget-avec-formules.xlsx")}catch(o){console.error("Error exporting to Excel:",o)}}}},xe={class:"flex gap-8 mt-6 w-full md:max-w-3/4"},Ce={class:"flex flex-col lg:flex-row gap-10 mt-6"},Ee={key:0,class:"flex justify-end mt-14"},be={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3"},Re={key:0,class:"mt-4 text-center font-bold text-xl"},it=N({__name:"index",setup(w){ce({title:"Prévision d’épargne mois par mois",description:"Estimez facilement votre épargne potentielle en entrant vos revenus et dépenses. Visualisez un tableau mois par mois pour mieux gérer votre budget.",ogTitle:"Prévision d’épargne mois par mois",ogDescription:"Visualisez votre épargne potentielle mois par mois avec Monea. Entrez vos revenus et dépenses pour un meilleur suivi de votre budget."});const e=ae({start:void 0,end:void 0,enters:[{name:null,value:null}],exits:[{name:null,value:null}]}),{months:a}=$e({form:e}),m=J(()=>{if(!(e.value.enters.some(i=>i.name&&i.value!=null)||e.value.exits.some(i=>i.name&&i.value!=null)))return[];const o=[];for(let i=0;i<a.value.length;i++){let c=0,t=0;e.value.enters.forEach(n=>{n.value!=null&&(c+=n.value)}),e.value.exits.forEach(n=>{n.value!=null&&(t+=n.value)});const r=o[o.length-1]||0;o.push(c-t+r)}return o}),{exportFormToExcel:p}=he({form:e.value,months:a.value,savings:m.value});return(g,o)=>{const i=_e,c=G,t=me,r=we,n=ue,$=ie,u=se;return _(),x(F,null,[v("div",xe,[f(b(j),{modelValue:e.value.start,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value.start=d),"date-format":"dd/mm/yy","show-icon":"",fluid:"",class:"w-full","icon-display":"input",placeholder:"Date de début"},null,8,["modelValue"]),f(b(j),{modelValue:e.value.end,"onUpdate:modelValue":o[1]||(o[1]=d=>e.value.end=d),"date-format":"dd/mm/yy","show-icon":"",fluid:"",class:"w-full","icon-display":"input",placeholder:"Date de fin"},null,8,["modelValue"])]),v("div",Ce,[f(i,{form:e.value,category:"enters"},null,8,["form"]),f(i,{form:e.value,category:"exits"},null,8,["form"])]),b(a).length>0?(_(),x("div",Ee,[f(c,{icon:"pi pi-file-export",label:"Exporter via Excel",onClick:o[2]||(o[2]=async()=>await b(p)())})])):D("",!0),f(u,{value:0,class:"shadow-sm mt-3"},{default:h(()=>[(_(!0),x(F,null,U(b(a),(d,y)=>(_(),T($,{key:y,value:y},{default:h(()=>[f(t,null,{default:h(()=>[H(R(d),1)]),_:2},1024),f(n,null,{default:h(()=>[v("div",be,[f(r,{category:"enters",form:e.value},null,8,["form"]),f(r,{category:"exits",form:e.value},null,8,["form"])]),isNaN(m.value[y])?D("",!0):(_(),x("p",Re," Epargne : "+R(m.value[y])+" € ",1))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})],64)}}});export{it as default};
