import{_ as Y}from"./CkjdEKrZ.js";import{_ as Z}from"./Ca2FGNrf.js";import{_ as I}from"./DruMC_ug.js";import{e as E,r as y,N as ee,q as le,k as g,o as n,w as f,a as p,b as u,u as e,c as b,n as M,l as V,O as H,P as w,F as S,f as j,J as oe,Q as J,s as te,j as ae,S as k,T as se}from"./B4C1c3y9.js";import{u as ne}from"./BLOsYvQj.js";import L from"./GLQTXrRA.js";import re from"./DV0oAg31.js";import F from"./CDF5jS1J.js";import{_ as O}from"./Be9F72kc.js";import ue from"./B5bcPuAO.js";import ie from"./BbMESLM0.js";import ce from"./CAseemDN.js";import"./C_ygJkaK.js";import{h as de}from"./HNDTOkeZ.js";import{g as R}from"./8G3UIhLy.js";import{u as pe}from"./BGu5VaWk.js";import me from"./wYo_xwdP.js";import q from"./CxA7oa0I.js";const ve={class:"w-full lg:w-3/4 flex flex-col items-end"},fe={class:"flex flex-col md:flex-row gap-5 w-full"},ge=E({__name:"MembersForm",props:{group:{}},setup($){var _;const s=(_=$.group)==null?void 0:_.id,a=y(""),c=ee.options,i=y(c[0]),{sendInvitation:h}=ne(),v=le({mutationFn:h,onSuccess:()=>{a.value=""},onError:m=>{console.error("Erreur lors de l'invitation :",m)}}),d=()=>{!a.value||!s||v.mutate({role:i.value,groupeId:s,username:a.value&&!a.value.includes("@")?a.value:void 0,mail:a.value&&a.value.includes("@")?a.value:void 0})};return(m,o)=>(n(),g(I,{label:"Ajouter un membre"},{default:f(()=>[p("div",ve,[p("div",fe,[u(e(L),{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value=t),placeholder:"Pseudo/mail",class:"w-full",fluid:""},null,8,["modelValue"]),u(e(re),{modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value=t),options:e(c),placeholder:"Choisissez un role",class:"w-full md:w-56"},null,8,["modelValue","options"])]),u(e(F),{variant:"outlined",size:"small",class:"mt-2 ml-auto",onClick:d,icon:"pi pi-inbox",label:"Envoyer la demande"})])]),_:1}))}}),Q=E({__name:"ChoiceColor",props:{color:{},selected:{type:Boolean}},setup($){return(l,s)=>(n(),b("div",{class:M(["h-12 rounded-sm flex justify-center items-center transition",[`bg-${l.color}-200 hover:bg-${l.color}-300`]])},[l.selected?(n(),b("i",{key:0,class:M(["pi pi-check",[`text-${l.color}-600`]]),style:{"font-weight":"bold"}},null,2)):V("",!0)],2))}}),_e={class:"grid grid-cols-5 md:grid-cols-6 gap-4"},ye={class:"flex justify-end"},be=E({__name:"CategoryForm",props:{category:{},onSaveCategory:{type:Function},mode:{},modelValue:{type:Boolean}},emits:["update:modelValue"],setup($,{emit:l}){const s=$,a=l,c=y({label:"",color:"gray"}),i=y(null);H(()=>s.modelValue,v=>{if(v){c.value=s.category?{...s.category}:{label:"",color:"gray"};const d=w.options.filter(_=>_!=="gray");i.value=s.category?d.indexOf(s.category.color):null}});const h=()=>{if(!c.value.label||i.value===null)return;const v={label:c.value.label,color:w.options.filter(d=>d!=="gray")[i.value]};s.onSaveCategory(v),a("update:modelValue",!1)};return(v,d)=>{const _=Q;return n(),g(e(ue),{visible:v.modelValue,modal:"",header:v.mode==="edit"?"Modifier la catégorie":"Créer une catégorie",style:{width:"25rem"},"onUpdate:visible":d[1]||(d[1]=m=>a("update:modelValue",m))},{default:f(()=>[u(e(ie),{variant:"on",class:"mt-1"},{default:f(()=>[u(e(L),{id:"label",modelValue:c.value.label,"onUpdate:modelValue":d[0]||(d[0]=m=>c.value.label=m)},null,8,["modelValue"]),d[2]||(d[2]=p("label",{for:"label"},"Nom",-1))]),_:1,__:[2]}),u(I,{label:"Choisir la couleur",class:"my-6"},{default:f(()=>[p("div",_e,[(n(!0),b(S,null,j(e(w).options.filter(m=>m!=="gray"),(m,o)=>(n(),g(_,{key:o,color:m,selected:i.value===o,onClick:t=>i.value=o},null,8,["color","selected","onClick"]))),128))])]),_:1}),p("div",ye,[u(e(F),{label:v.mode==="edit"?"Sauvegarder":"Ajouter",onClick:h},null,8,["label"])])]),_:1},8,["visible","header"])}}}),Ce=[{label:"Abonnement",color:"red"},{label:"Course",color:"blue"},{label:"Famille",color:"green"},{label:"Santé",color:"orange"}],$e={class:"flex gap-1.5 flex-wrap"},he=["onClick"],xe=["onClick"],ke={class:"flex gap-1.5 flex-wrap"},Ve=["onClick"],we=E({__name:"CategoriesSelection",props:{modelValue:{default:[]},modelModifiers:{}},emits:["update:modelValue"],setup($){const l=oe($,"modelValue"),s=y(void 0),a=y("create"),c=y(!1),i=y(Ce),h=({category:o})=>{l.value.push(o);const t=i.value.indexOf(o);i.value.splice(t,1)},v=({category:o})=>{if(!l.value)return;const t=l==null?void 0:l.value.indexOf(o);l==null||l.value.splice(t,1),i.value.push(o)},d=()=>{s.value=void 0,a.value="create",c.value=!0},_=o=>{s.value=o,a.value="edit",c.value=!0},m=o=>{if(l.value)if(a.value==="edit"&&s.value){const t=l==null?void 0:l.value.findIndex(r=>{var C;return r.label===((C=s.value)==null?void 0:C.label)});t!==-1&&(l.value[t]=o)}else{l==null||l.value.push(o);const t=i.value.findIndex(r=>r.label===o.label);t!==-1&&i.value.splice(t,1)}};return(o,t)=>(n(),b(S,null,[l.value.length?(n(),g(I,{key:0,label:"Catégorie sélectionné"},{default:f(()=>[p("div",$e,[(n(!0),b(S,null,j(l.value,(r,C)=>(n(),g(O,{key:C,category:r,add:""},{add:f(()=>[p("i",{class:"pi pi-pencil",onClick:N=>_(r)},null,8,he),p("i",{class:"pi pi-minus",onClick:N=>v({category:r})},null,8,xe)]),_:2},1032,["category"]))),128))])]),_:1})):V("",!0),u(I,{label:"Ajouter une catégorie"},{default:f(()=>[p("div",ke,[(n(!0),b(S,null,j(e(i),(r,C)=>(n(),g(O,{key:C,category:r,add:""},{add:f(()=>[p("i",{class:"pi pi-plus",onClick:N=>h({category:r})},null,8,Ve)]),_:2},1032,["category"]))),128)),u(O,{onClick:d}),u(be,{modelValue:e(c),"onUpdate:modelValue":t[0]||(t[0]=r=>J(c)?c.value=r:null),category:e(s),mode:e(a),"on-save-category":m},null,8,["modelValue","category","mode"])])]),_:1})],64))}}),Se={class:"flex items-center gap-2"},Me=["for"],Fe={class:"flex items-center gap-2"},Ie=["for"],Ee={class:"grid grid-cols-5 md:grid-cols-6 lg:grid-cols-8 gap-4"},Ne={key:3,class:"flex flex-col gap-3 w-64 self-center"},je={key:4,class:"flex justify-center"},Ze=E({__name:"GroupForm",setup($){const{group:l}=te(ae()),s=y(null),a=y([]);H(()=>l.value,o=>{var t;o&&(s.value=o.color&&o.color!=="gray"?w.options.filter(r=>r!=="gray").indexOf(o.color):null,a.value=((t=o.categories)==null?void 0:t.filter(r=>r.label!=="default"))??[])},{immediate:!0});const{createGroupMutation:c,editGroupMutation:i,deleteGroupMutation:h}=pe(l),v=o=>{s.value=s.value===o?null:o},d=o=>{if(s.value===null)return;const t={name:o.states.name.value,type:o.states.type.value,color:w.options.filter(r=>r!=="gray")[s.value],categories:a.value};l.value?i.mutate(t):c.mutate(t)},_=()=>{confirm("Es-tu sûr de vouloir supprimer le groupe ?")&&h.mutate()},m=l.value&&l.value?{name:l.value.name??"",type:l.value.type}:{};return(o,t)=>{const r=Y,C=Z,N=ge,U=I,K=Q,W=we;return n(),b(S,null,[u(r,{label:e(l)?e(l).name:"Nouveau group",color:e(l)?e(l).color:"gray",to:e(l)?`/groups/${e(l).id}`:"/groups"},null,8,["label","color","to"]),u(e(ce),{"initial-values":e(m),resolver:e(de)(e(se)),class:"flex flex-col gap-10",onSubmit:d},{default:f(X=>{var G,A,T,z,D,P;return[((G=e(l))==null?void 0:G.type)!=="personnal"?(n(),g(C,{key:0,class:"w-full lg:w-3/4",placeholder:"Nom du group",name:"name",form:X,fluid:""},null,8,["form"])):V("",!0),(A=e(l))!=null&&A.id&&((T=e(l))==null?void 0:T.type)!=="personnal"?(n(),g(N,{key:1,group:e(l)},null,8,["group"])):V("",!0),((z=e(l))==null?void 0:z.type)!=="personnal"?(n(),g(U,{key:2,label:"Type de groupe"},{default:f(()=>[u(e(me),{name:"type",class:"flex flex-wrap gap-4"},{default:f(()=>[p("div",Se,[u(e(q),{"input-id":e(k).options[1],value:e(k).options[1]},null,8,["input-id","value"]),p("label",{for:e(k).options[1]},"Occasional",8,Me)]),p("div",Fe,[u(e(q),{"input-id":e(k).options[2],value:e(k).options[2]},null,8,["input-id","value"]),p("label",{for:e(k).options[2]},"Régulier",8,Ie)])]),_:1})]),_:1})):V("",!0),u(U,{label:"Choisir la couleur"},{default:f(()=>[p("div",Ee,[(n(!0),b(S,null,j(e(w).options.filter(x=>x!=="gray"),(x,B)=>(n(),g(K,{key:B,color:x,selected:e(s)===B,onClick:Be=>v(B)},null,8,["color","selected","onClick"]))),128))])]),_:1}),u(W,{modelValue:e(a),"onUpdate:modelValue":t[0]||(t[0]=x=>J(a)?a.value=x:null)},null,8,["modelValue"]),e(l)?(n(),b("div",Ne,[u(e(F),{class:M([e(R)({color:(D=e(l))==null?void 0:D.color})]),type:"submit",label:"Modifier le groupe"},null,8,["class"]),e(l).type!=="personnal"&&e(l).userRole==="author"?(n(),g(e(F),{key:0,variant:"outlined",class:M(e(R)({color:(P=e(l))==null?void 0:P.color,outlined:!0})),label:"Supprimer le groupe",onClick:t[1]||(t[1]=x=>_())},null,8,["class"])):V("",!0)])):(n(),b("div",je,[u(e(F),{class:M(["w-64",[e(R)({color:"gray"})]]),type:"submit",label:"Créer le groupe"},null,8,["class"])]))]}),_:1},8,["initial-values","resolver"])],64)}}});export{Ze as _};
