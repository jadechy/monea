const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DigIgAcp.js","./Cpj98o6Y.js","./CshrRwMP.js"])))=>i.map(i=>d[i]);
import{d as D,J as Z,K as ee,l as T,w as h,s as te,o as _,e as v,c as x,a as U,F,q as J,t as R,m as N,b as f,g as O,M as W,N as j,r as oe,u as b}from"./DZ2khTnM.js";import le from"./BVLwsKNB.js";import re from"./xFnIkFpr.js";import ae from"./Cnm4LbfB.js";import ne from"./BMC8lClx.js";import se from"./DWMtnMl9.js";import ie from"./BJgX3a_o.js";import ue from"./CkLv55e1.js";import ce from"./CeIP7WQU.js";import I from"./u-qg8O4J.js";import{u as me}from"./DDT-kY3b.js";import"./BK5zw7wc.js";import"./9bD6E8Nq.js";import"./Hbwuj-1z.js";import"./BO-eBnTB.js";import"./DPiWrF-R.js";import"./kD-r-boF.js";import"./dV31eLeC.js";import"./CFd5_Piq.js";import"./CLs7nh7g.js";import"./DQrM28XS.js";import"./B3kXyQam.js";import"./N6u5SXv9.js";import"./BCFG6or-.js";const de={class:"flex flex-col gap-14 sm:gap-8 mt-3"},pe={class:"flex gap-6"},fe=["for"],ge={class:"flex gap-3 items-center"},ve=["for"],_e=D({__name:"NewEnter",props:Z({category:{}},{form:{},formModifiers:{}}),emits:["update:form"],setup(w){const e=ee(w,"form");return(a,u)=>{const d=ae,g=re,o=le,s=O,c=te;return _(),T(c,null,{title:h(()=>[J(R(a.category==="exits"?"Sortie":"Entrée")+" d'argent",1)]),content:h(()=>{var t;return[v("div",de,[(_(!0),x(F,null,U((t=e.value)==null?void 0:t[a.category],(r,m)=>{var $;return _(),x("div",{key:m,class:"flex gap-8 justify-between sm:flex-row flex-col"},[v("div",pe,[f(g,{class:"w-40"},{default:h(()=>[f(d,{modelValue:r.name,"onUpdate:modelValue":i=>r.name=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"]),v("label",{for:`${r}-${m}-name`},"Nom",8,fe)]),_:2},1024),v("div",ge,[f(g,{class:"w-22"},{default:h(()=>[f(o,{modelValue:r.value,"onUpdate:modelValue":i=>r.value=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"]),v("label",{for:`${r}-${m}-value`},"Montant",8,ve)]),_:2},1024),u[1]||(u[1]=v("p",{class:"font-bold text-3xl"},"€",-1))])]),($=e.value)!=null&&$[a.category]&&m===e.value[a.category].length-1?(_(),T(s,{key:0,class:"h-fit",disabled:!(r.name&&r.name.trim()!==""&&r.value!==null),icon:"pi pi-plus","aria-label":`add ${a.category}`,onClick:u[0]||(u[0]=i=>{var p;return(p=e.value)==null?void 0:p[a.category].push({name:null,value:null})})},null,8,["disabled","aria-label"])):N("",!0)])}),128))])]}),_:1})}}}),ye={class:"flex gap-2 items-center"},we=D({__name:"RowSavings",props:{form:{},category:{}},setup(w){return(e,a)=>{const u=ne;return _(!0),x(F,null,U(e.form[e.category].filter(d=>d.name&&d.value!=null),(d,g)=>(_(),x("div",{key:e.category+"-"+g,class:"item rounded shadow-sm h-fit"},[v("div",ye,[f(u,{severity:e.category==="enters"?"success":"danger",value:e.category==="enters"?"Entrée":"Sortie"},null,8,["severity","value"]),v("p",null,R(d.name),1)]),v("p",null,R(d.value)+" €",1)]))),128)}}}),$e=({form:w})=>({months:W(()=>{const a=w.value.start,u=w.value.end;if(!a||!u)return[];const d=[],g=new Date(a.getFullYear(),a.getMonth(),1),o=new Date(u.getFullYear(),u.getMonth(),1);for(;g<=o;)d.push(g.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})),g.setMonth(g.getMonth()+1);return d})}),he=({form:w,months:e,savings:a})=>{const u=({category:o})=>w[o].filter(c=>c.name&&c.value!=null).map(c=>{const t={Type:o==="enters"?"Entrée":"Sortie",Nom:c.name};return e.forEach(r=>{t[r]=c.value}),t}),d=({worksheet:o,enterEndRow:s,summaryStartRow:c,categoryItems:t,categoryType:r})=>{const $=`C2:C${s}`,i=o.getRow(c);i.getCell(1).value=`Total ${r==="enters"?"Entrées":"Sorties"}`,i.getCell(3).value={formula:`SUM(${$})`,result:t.reduce((p,y)=>p+y[e[0]],0)}};return{exportFormToExcel:async()=>{try{const[o,s]=await Promise.all([j(()=>import("./DigIgAcp.js").then(l=>l.e),__vite__mapDeps([0,1]),import.meta.url),j(()=>import("./CshrRwMP.js").then(l=>l.F),__vite__mapDeps([2,1]),import.meta.url)]),c=new o.default.Workbook,t=c.addWorksheet("Budget");t.columns=[{header:"Type",key:"Type",width:15},{header:"Nom",key:"Nom",width:30},...e.map(l=>({header:l,key:l,width:18}))];const r=u({category:"enters"}),m=u({category:"exits"}),$=[...r,...m];t.addRows($);const i=1+r.length,p=1+r.length+m.length,y=p+1,L={Type:"Total",Nom:"Épargne Cumulative"};e.forEach((l,n)=>{const C=String.fromCharCode(67+n),A=`${C}2:${C}${i}`,P=`${C}${i+1}:${C}${p}`;let k,M;if(n===0)k=`SUM(${A})-SUM(${P})`,M=a[n];else{const X=String.fromCharCode(67+n-1);k=`SUM(${A})-SUM(${P})+${X}${y}`,M=a[n]+(a[n-1]||0)}L[l]={formula:k,result:M}}),t.addRow(L),t.addRow([]);const E=y+2;d({worksheet:t,enterEndRow:i,summaryStartRow:E,categoryItems:r,categoryType:"enters"}),d({worksheet:t,enterEndRow:i+1,summaryStartRow:E+1,categoryItems:m,categoryType:"exits"});const S="C",Y=`${S}2:${S}${i}`,q=`${S}${i+1}:${S}${p}`,B=t.getRow(E+2);B.getCell(1).value="Épargne Mensuelle",B.getCell(3).value={formula:`SUM(${Y})-SUM(${q})`,result:a[0]};const V=t.getRow(1);V.font={bold:!0,size:12},V.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD3D3D3"}},V.alignment={horizontal:"center",vertical:"middle"};for(let l=2;l<=i;l++){const n=t.getRow(l);n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE8F5E8"}},n.getCell(1).font={bold:!0}}for(let l=i+1;l<=p;l++){const n=t.getRow(l);n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFCE8E8"}},n.getCell(1).font={bold:!0}}const z=t.getRow(y);z.font={bold:!0,size:12},z.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFF2CC"}};for(let l=E;l<=E+2;l++){const n=t.getRow(l);n.getCell(1).font={bold:!0},n.getCell(2).font={bold:!0}}const G=2+e.length,H=E+2;for(let l=2;l<=H;l++)for(let n=3;n<=G;n++){const C=t.getCell(l,n);C.numFmt="#,##0.00",C.alignment={horizontal:"right"}}const K=await c.xlsx.writeBuffer(),Q=new Blob([K],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});s.saveAs(Q,"budget-avec-formules.xlsx")}catch(o){console.error("Error exporting to Excel:",o)}}}},xe={class:"flex gap-8 mt-6 w-full md:max-w-3/4"},Ce={class:"flex flex-col lg:flex-row gap-10 mt-6"},Ee={key:0,class:"flex justify-end mt-14"},be={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3"},Re={key:0,class:"mt-4 text-center font-bold text-xl"},Qe=D({__name:"index",setup(w){me({title:"Prévision d’épargne mois par mois",description:"Estimez facilement votre épargne potentielle en entrant vos revenus et dépenses. Visualisez un tableau mois par mois pour mieux gérer votre budget.",ogTitle:"Prévision d’épargne mois par mois",ogDescription:"Visualisez votre épargne potentielle mois par mois avec Monea. Entrez vos revenus et dépenses pour un meilleur suivi de votre budget."});const e=oe({start:void 0,end:void 0,enters:[{name:null,value:null}],exits:[{name:null,value:null}]}),{months:a}=$e({form:e}),u=W(()=>{if(!(e.value.enters.some(s=>s.name&&s.value!=null)||e.value.exits.some(s=>s.name&&s.value!=null)))return[];const o=[];for(let s=0;s<a.value.length;s++){let c=0,t=0;e.value.enters.forEach(m=>{m.value!=null&&(c+=m.value)}),e.value.exits.forEach(m=>{m.value!=null&&(t+=m.value)});const r=o[o.length-1]||0;o.push(c-t+r)}return o}),{exportFormToExcel:d}=he({form:e.value,months:a.value,savings:u.value});return(g,o)=>{const s=_e,c=O,t=ce,r=we,m=ue,$=ie,i=se;return _(),x(F,null,[v("div",xe,[f(b(I),{modelValue:e.value.start,"onUpdate:modelValue":o[0]||(o[0]=p=>e.value.start=p),"date-format":"dd/mm/yy","show-icon":"",fluid:"",class:"w-full","icon-display":"input",placeholder:"Date de début"},null,8,["modelValue"]),f(b(I),{modelValue:e.value.end,"onUpdate:modelValue":o[1]||(o[1]=p=>e.value.end=p),"date-format":"dd/mm/yy","show-icon":"",fluid:"",class:"w-full","icon-display":"input",placeholder:"Date de fin"},null,8,["modelValue"])]),v("div",Ce,[f(s,{form:e.value,category:"enters"},null,8,["form"]),f(s,{form:e.value,category:"exits"},null,8,["form"])]),b(a).length>0?(_(),x("div",Ee,[f(c,{icon:"pi pi-file-export",label:"Exporter via Excel",onClick:o[2]||(o[2]=async()=>await b(d)())})])):N("",!0),f(i,{value:0,class:"shadow-sm mt-3"},{default:h(()=>[(_(!0),x(F,null,U(b(a),(p,y)=>(_(),T($,{key:y,value:y},{default:h(()=>[f(t,null,{default:h(()=>[J(R(p),1)]),_:2},1024),f(m,null,{default:h(()=>[v("div",be,[f(r,{category:"enters",form:e.value},null,8,["form"]),f(r,{category:"exits",form:e.value},null,8,["form"])]),isNaN(u.value[y])?N("",!0):(_(),x("p",Re," Epargne : "+R(u.value[y])+" € ",1))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})],64)}}});export{Qe as default};
