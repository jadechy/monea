import{_ as Y}from"./BXLN-2ti.js";import{_ as Z}from"./xpL0GtKN.js";import{_ as I}from"./BY0E9GD9.js";import{d as E,r as b,O as ee,x as le,l as g,o as r,w as f,e as p,b as u,u as l,g as M,c as C,n as F,m as V,P as K,Q as w,F as S,a as B,K as oe,S as L,j as te,k as ae,T as k,V as se}from"./DZ2khTnM.js";import{u as ne}from"./BC-j4gIq.js";import Q from"./Cnm4LbfB.js";import re from"./BRjEZLyQ.js";import{_ as O}from"./C0Kuc3g1.js";import ue from"./yCPM-K_V.js";import ie from"./xFnIkFpr.js";import ce from"./BQuv8gv2.js";import"./D0fJx_nL.js";import{h as de}from"./DuJv_D_N.js";import{g as R}from"./8G3UIhLy.js";import{u as pe}from"./DLU0dq0J.js";import me from"./B1oGKBrE.js";import H from"./D2FHerwe.js";const ve={class:"w-full lg:w-3/4 flex flex-col items-end"},fe={class:"flex flex-col md:flex-row gap-5 w-full"},ge=E({__name:"MembersForm",props:{group:{}},setup(x){var _;const s=(_=x.group)==null?void 0:_.id,a=b(""),c=ee.options,i=b(c[0]),{sendInvitation:$}=ne(),v=le({mutationFn:$,onSuccess:()=>{a.value=""},onError:m=>{console.error("Erreur lors de l'invitation :",m)}}),d=()=>{!a.value||!s||v.mutate({role:i.value,groupeId:s,username:a.value&&!a.value.includes("@")?a.value:void 0,mail:a.value&&a.value.includes("@")?a.value:void 0})};return(m,o)=>(r(),g(I,{label:"Ajouter un membre"},{default:f(()=>[p("div",ve,[p("div",fe,[u(l(Q),{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value=t),placeholder:"Pseudo/mail",class:"w-full",fluid:""},null,8,["modelValue"]),u(l(re),{modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value=t),options:l(c),placeholder:"Choisissez un role",class:"w-full md:w-56"},null,8,["modelValue","options"])]),u(l(M),{variant:"outlined",size:"small",class:"mt-2 ml-auto",onClick:d,icon:"pi pi-inbox",label:"Envoyer la demande"})])]),_:1}))}}),q=E({__name:"ChoiceColor",props:{color:{},selected:{type:Boolean}},setup(x){return(e,s)=>(r(),C("div",{class:F(["h-12 rounded-sm flex justify-center items-center transition",[`bg-${e.color}-200 hover:bg-${e.color}-300`]])},[e.selected?(r(),C("i",{key:0,class:F(["pi pi-check",[`text-${e.color}-600`]]),style:{"font-weight":"bold"}},null,2)):V("",!0)],2))}}),_e={class:"grid grid-cols-5 md:grid-cols-6 gap-4"},ye={class:"flex justify-end"},be=E({__name:"CategoryForm",props:{category:{},onSaveCategory:{type:Function},mode:{},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(x,{emit:e}){const s=x,a=e,c=b({label:"",color:"gray"}),i=b(null);K(()=>s.modelValue,v=>{if(v){c.value=s.category?{...s.category}:{label:"",color:"gray"};const d=w.options.filter(_=>_!=="gray");i.value=s.category?d.indexOf(s.category.color):null}});const $=()=>{if(!c.value.label||i.value===null)return;const v={label:c.value.label,color:w.options.filter(d=>d!=="gray")[i.value]};s.onSaveCategory(v),a("update:modelValue",!1)};return(v,d)=>{const _=q;return r(),g(l(ue),{visible:v.modelValue,modal:"",header:v.mode==="edit"?"Modifier la catégorie":"Créer une catégorie",style:{width:"25rem"},"onUpdate:visible":d[1]||(d[1]=m=>a("update:modelValue",m))},{default:f(()=>[u(l(ie),{variant:"on",class:"mt-1"},{default:f(()=>[u(l(Q),{id:"label",modelValue:c.value.label,"onUpdate:modelValue":d[0]||(d[0]=m=>c.value.label=m)},null,8,["modelValue"]),d[2]||(d[2]=p("label",{for:"label"},"Nom",-1))]),_:1,__:[2]}),u(I,{label:"Choisir la couleur",class:"my-6"},{default:f(()=>[p("div",_e,[(r(!0),C(S,null,B(l(w).options.filter(m=>m!=="gray"),(m,o)=>(r(),g(_,{key:o,color:m,selected:i.value===o,onClick:t=>i.value=o},null,8,["color","selected","onClick"]))),128))])]),_:1}),p("div",ye,[u(l(M),{label:v.mode==="edit"?"Sauvegarder":"Ajouter",onClick:$},null,8,["label"])])]),_:1},8,["visible","header"])}}}),Ce=[{label:"Abonnement",color:"red"},{label:"Course",color:"blue"},{label:"Famille",color:"green"},{label:"Santé",color:"orange"}],xe={class:"flex gap-1.5 flex-wrap"},$e=["onClick"],he=["onClick"],ke={class:"flex gap-1.5 flex-wrap"},Ve=["onClick"],we=E({__name:"CategoriesSelection",props:{modelValue:{default:[]},modelModifiers:{}},emits:["update:modelValue"],setup(x){const e=oe(x,"modelValue"),s=b(void 0),a=b("create"),c=b(!1),i=b(Ce),$=({category:o})=>{e.value.push(o);const t=i.value.indexOf(o);i.value.splice(t,1)},v=({category:o})=>{if(!e.value)return;const t=e==null?void 0:e.value.indexOf(o);e==null||e.value.splice(t,1),i.value.push(o)},d=()=>{s.value=void 0,a.value="create",c.value=!0},_=o=>{s.value=o,a.value="edit",c.value=!0},m=o=>{if(e.value)if(a.value==="edit"&&s.value){const t=e==null?void 0:e.value.findIndex(n=>{var y;return n.label===((y=s.value)==null?void 0:y.label)});t!==-1&&(e.value[t]=o)}else{e==null||e.value.push(o);const t=i.value.findIndex(n=>n.label===o.label);t!==-1&&i.value.splice(t,1)}};return(o,t)=>(r(),C(S,null,[e.value.length?(r(),g(I,{key:0,label:"Catégorie sélectionné"},{default:f(()=>[p("div",xe,[(r(!0),C(S,null,B(e.value,(n,y)=>(r(),g(O,{key:y,category:n,add:""},{add:f(()=>[p("i",{class:"pi pi-pencil",onClick:j=>_(n)},null,8,$e),p("i",{class:"pi pi-minus",onClick:j=>v({category:n})},null,8,he)]),_:2},1032,["category"]))),128))])]),_:1})):V("",!0),u(I,{label:"Ajouter une catégorie"},{default:f(()=>[p("div",ke,[(r(!0),C(S,null,B(l(i),(n,y)=>(r(),g(O,{key:y,category:n,add:""},{add:f(()=>[p("i",{class:"pi pi-plus",onClick:j=>$({category:n})},null,8,Ve)]),_:2},1032,["category"]))),128)),u(O,{onClick:d}),u(be,{modelValue:l(c),"onUpdate:modelValue":t[0]||(t[0]=n=>L(c)?c.value=n:null),category:l(s),mode:l(a),"on-save-category":m},null,8,["modelValue","category","mode"])])]),_:1})],64))}}),Se={class:"flex items-center gap-2"},Me=["for"],Fe={class:"flex items-center gap-2"},Ie=["for"],Ee={class:"grid grid-cols-5 md:grid-cols-6 lg:grid-cols-8 gap-4"},je={key:3,class:"flex flex-col gap-3 w-64 self-center"},Be={key:4,class:"flex justify-center"},Ye=E({__name:"GroupForm",setup(x){const{group:e}=te(ae()),s=b(null),a=b([]);K(()=>e.value,o=>{var t;o&&(s.value=o.color&&o.color!=="gray"?w.options.filter(n=>n!=="gray").indexOf(o.color):null,a.value=((t=o.categories)==null?void 0:t.filter(n=>n.label!=="default"))??[])},{immediate:!0});const{createGroupMutation:c,editGroupMutation:i,deleteGroupMutation:$}=pe(e),v=o=>{s.value=s.value===o?null:o},d=o=>{var n;if(s.value===null)return;const t={name:o.states.name?o.states.name.value:(n=e.value)==null?void 0:n.name,type:o.states.type?o.states.type.value:"personnal",color:w.options.filter(y=>y!=="gray")[s.value],categories:a.value};e.value?i.mutate(t):c.mutate(t)},_=()=>{confirm("Es-tu sûr de vouloir supprimer le groupe ?")&&$.mutate()},m=e.value&&e.value?{name:e.value.name??"",type:e.value.type}:{};return(o,t)=>{const n=Y,y=Z,j=ge,U=I,J=q,W=we;return r(),C(S,null,[u(n,{label:l(e)?l(e).name:"Nouveau group",color:l(e)?l(e).color:"gray",to:l(e)?`/groups/${l(e).id}`:"/groups"},null,8,["label","color","to"]),u(l(ce),{"initial-values":l(m),resolver:l(de)(l(se)),class:"flex flex-col gap-10",onSubmit:d},{default:f(X=>{var G,A,T,z,D,P;return[((G=l(e))==null?void 0:G.type)!=="personnal"?(r(),g(y,{key:0,class:"w-full lg:w-3/4",placeholder:"Nom du group",name:"name",form:X,fluid:""},null,8,["form"])):V("",!0),(A=l(e))!=null&&A.id&&((T=l(e))==null?void 0:T.type)!=="personnal"?(r(),g(j,{key:1,group:l(e)},null,8,["group"])):V("",!0),((z=l(e))==null?void 0:z.type)!=="personnal"?(r(),g(U,{key:2,label:"Type de groupe"},{default:f(()=>[u(l(me),{name:"type",class:"flex flex-wrap gap-4"},{default:f(()=>[p("div",Se,[u(l(H),{"input-id":l(k).options[1],value:l(k).options[1]},null,8,["input-id","value"]),p("label",{for:l(k).options[1]},"Occasional",8,Me)]),p("div",Fe,[u(l(H),{"input-id":l(k).options[2],value:l(k).options[2]},null,8,["input-id","value"]),p("label",{for:l(k).options[2]},"Régulier",8,Ie)])]),_:1})]),_:1})):V("",!0),u(U,{label:"Choisir la couleur"},{default:f(()=>[p("div",Ee,[(r(!0),C(S,null,B(l(w).options.filter(h=>h!=="gray"),(h,N)=>(r(),g(J,{key:N,color:h,selected:l(s)===N,onClick:Ne=>v(N)},null,8,["color","selected","onClick"]))),128))])]),_:1}),u(W,{modelValue:l(a),"onUpdate:modelValue":t[0]||(t[0]=h=>L(a)?a.value=h:null)},null,8,["modelValue"]),l(e)?(r(),C("div",je,[u(l(M),{class:F([l(R)({color:(D=l(e))==null?void 0:D.color})]),type:"submit",label:"Modifier le groupe"},null,8,["class"]),l(e).type!=="personnal"&&l(e).userRole==="author"?(r(),g(l(M),{key:0,variant:"outlined",class:F(l(R)({color:(P=l(e))==null?void 0:P.color,outlined:!0})),label:"Supprimer le groupe",onClick:t[1]||(t[1]=h=>_())},null,8,["class"])):V("",!0)])):(r(),C("div",Be,[u(l(M),{class:F(["w-64",[l(R)({color:"gray"})]]),type:"submit",label:"Créer le groupe"},null,8,["class"])]))]}),_:1},8,["initial-values","resolver"])],64)}}});export{Ye as _};
