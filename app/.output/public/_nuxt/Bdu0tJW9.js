import{_ as G}from"./F6JjwL24.js";import{_ as O}from"./C5cMZrgP.js";import A from"./ChxjcQKA.js";import{e as I,c,o as n,b as m,u as e,K as E,r as C,y as T,s as H,j as K,N as U,I as W,a as p,k as V,w as j,F as k,f as q,n as z,t as J}from"./Ckx6mslq.js";import{g as P}from"./8G3UIhLy.js";import{u as Q}from"./Bk1URDdc.js";import X from"./yBq3KrFS.js";import"./DjLTLL36.js";import{h as Y}from"./hliVSVGF.js";import{N as Z}from"./CVB7d1-_.js";import{u as ee}from"./M6p4avPA.js";import{u as te}from"./DKCi-7Lj.js";import{a as oe,g as re}from"./CPAmBVur.js";import se from"./C2aBvGvC.js";import ae from"./znsgla_a.js";import ie from"./BYVjy45l.js";import"./zYM93lHo.js";import"./B_hU_gsp.js";import"./DCBUWMB3.js";import"./Bp7hurWM.js";import"./XgRJLUtX.js";import"./CeqpDiTK.js";import"./DStCAHD-.js";import"./jc0MLXVe.js";import"./ZhWAdK_X.js";import"./ECYVZSqX.js";import"./CLs7nh7g.js";import"./CgRoJxKm.js";import"./hpvE0FI8.js";import"./BYZeV7uV.js";import"./uXoVVhWb.js";import"./CwYrG_0s.js";import"./BHFdxUAM.js";import"./CZUsjxIF.js";import"./ScxT_cxM.js";import"./B4bLV07v.js";import"./DYAB0jPi.js";import"./D8IgIHVC.js";const le={class:"w-full flex justify-center h-24"},ue=I({__name:"LoadingComponent",setup(M){return(b,f)=>(n(),c("div",le,[m(e(A),{"aria-label":"Loading"})]))}}),ne={class:"w-full flex justify-center"},me={class:"grid gap-2 grid-cols-2 md:grid-cols-3 mt-6 w-full"},pe={class:"flex items-center gap-2"},Qe=I({__name:"edit",setup(M){var $,y,x,h,S;const b=E(),{group_id:f}=b.params,s=C(null);T(()=>{s.value=new Date});const{group:a}=H(K()),g=C(null),{categories:l}=te();ee({title:`Modifier le budget du groupe ${($=a.value)==null?void 0:$.name}`,description:`Ajustez les montants par catégorie, modifiez les plafonds mensuels et gérez les priorités budgétaires du groupe ${(y=a.value)==null?void 0:y.name}.`,ogTitle:`Édition du budget - ${(x=a.value)==null?void 0:x.name}`,ogDescription:`Modifiez le budget partagé du groupe ${(h=a.value)==null?void 0:h.name} : ajustez les catégories, maîtrisez vos dépenses et anticipez les imprévus.`,image:((S=a.value)==null?void 0:S.picture)??void 0});const{refetchBudget:D,postBudgetsMutation:L,budgetList:v}=Q(s),w=()=>!v.value||!l.value?{}:l.value.reduce((t,o)=>{var u;return t[o.id]=((u=v.value.find(r=>Number(r.category.id)===Number(o.id)))==null?void 0:u.amount)??0,t},{});U(s,async()=>{if(l.value&&(await D(),g.value)){const t=w();g.value.setValues(t)}});const R=t=>{if(!t.valid||!l.value||!s.value)return;const o=Object.entries(t.states).map(r=>{var d;return{amount:Number(r[1]&&((d=r[1])!=null&&d.value)?r[1].value:0),monthStart:oe(re(s.value)),categoryId:Number(r[0])}}),u={groupId:Number(f),budgets:o};L.mutate(u)},F=W(()=>w());return(t,o)=>{var B;const u=G,r=O,d=ue;return n(),c(k,null,[m(u,{label:"Edition des Budgets",color:(B=e(a))==null?void 0:B.color,to:`/groups/${e(f)}/budget`},null,8,["color","to"]),p("div",ne,[m(e(se),{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=_=>s.value=_),view:"month","date-format":"mm/yy",class:"w-64 mt-3","input-class":"text-center"},null,8,["modelValue"])]),e(v)&&e(l)?(n(),V(e(X),{key:0,ref_key:"formRef",ref:g,"initial-values":F.value,resolver:e(Y)(e(Z)),class:"flex justify-center flex-col items-center gap-10",onSubmit:R},{default:j(_=>{var N;return[p("section",me,[(n(!0),c(k,null,q(e(l),i=>(n(),c("div",{key:i.id,class:z(["flex justify-between items-center rounded-full px-4 py-3",`bg-${i.color}-50 text-${i.color}-800`])},[p("p",null,J(i.label!=="default"?i.label:"Autres"),1),p("div",pe,[m(r,{form:_,name:String(i.id),placeholder:"Budget",class:"w-24"},{default:j(()=>[m(e(ae),{name:String(i.id),fluid:""},null,8,["name"])]),_:2},1032,["form","name"]),o[1]||(o[1]=p("p",{class:"text-2xl"},"€",-1))])],2))),128))]),m(e(ie),{class:z([[("getGroupColor"in t?t.getGroupColor:e(P))({color:(N=e(a))==null?void 0:N.color})],"w-64"]),type:"submit",label:"Sauvergarde les budgets"},null,8,["class"])]}),_:1},8,["initial-values","resolver"])):(n(),V(d,{key:1}))],64)}}});export{Qe as default};
