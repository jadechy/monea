const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DigIgAcp.js","./Cpj98o6Y.js","./CshrRwMP.js"])))=>i.map(i=>d[i]);
import Z from"./gaul-xYi.js";import J from"./CDF5jS1J.js";import ee from"./bSRVenpC.js";import te from"./BbMESLM0.js";import oe from"./GLQTXrRA.js";import{e as N,I as le,J as re,k as T,w as h,o as _,a as v,c as x,f as U,F,d as O,t as R,l as D,b as f,K as W,M as I,r as ae,u as b}from"./B4C1c3y9.js";import ne from"./f80WIipg.js";import se from"./Bwm3RfMV.js";import ie from"./hf5Xmvhc.js";import ue from"./DxfyS3MA.js";import me from"./CXYer7rI.js";import j from"./DvnhpT4c.js";import{u as ce}from"./C45g08Ar.js";import"./yOe6c3TM.js";import"./DfIvkuC_.js";import"./DGOriwfr.js";import"./DDRO_9ox.js";import"./ZhWAdK_X.js";import"./CG7fiWaA.js";import"./B-SteLpu.js";import"./jc0MLXVe.js";import"./cXyE4iZA.js";import"./B0jwk4p4.js";import"./BP-om_zl.js";import"./Drkg7K07.js";import"./DD9exzw8.js";import"./BTinR4uF.js";import"./BG6yOVPh.js";import"./AxJl-wT4.js";import"./CLs7nh7g.js";import"./Sx2Q1i01.js";import"./wgfyke9o.js";import"./DFCF-WRp.js";import"./DFRwXp6x.js";import"./C1pTgOiJ.js";const pe={class:"flex flex-col gap-14 sm:gap-8 mt-3"},de={class:"flex gap-6"},fe=["for"],ge={class:"flex gap-3 items-center"},ve=["for"],_e=N({__name:"NewEnter",props:le({category:{}},{form:{},formModifiers:{}}),emits:["update:form"],setup(w){const e=re(w,"form");return(a,u)=>{const p=oe,g=te,o=ee,s=J,m=Z;return _(),T(m,null,{title:h(()=>[O(R(a.category==="exits"?"Sortie":"Entrée")+" d'argent",1)]),content:h(()=>{var t;return[v("div",pe,[(_(!0),x(F,null,U((t=e.value)==null?void 0:t[a.category],(r,c)=>{var $;return _(),x("div",{key:c,class:"flex gap-8 justify-between sm:flex-row flex-col"},[v("div",de,[f(g,{class:"w-40"},{default:h(()=>[f(p,{modelValue:r.name,"onUpdate:modelValue":i=>r.name=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"]),v("label",{for:`${r}-${c}-name`},"Nom",8,fe)]),_:2},1024),v("div",ge,[f(g,{class:"w-22"},{default:h(()=>[f(o,{modelValue:r.value,"onUpdate:modelValue":i=>r.value=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"]),v("label",{for:`${r}-${c}-value`},"Montant",8,ve)]),_:2},1024),u[1]||(u[1]=v("p",{class:"font-bold text-3xl"},"€",-1))])]),($=e.value)!=null&&$[a.category]&&c===e.value[a.category].length-1?(_(),T(s,{key:0,class:"h-fit",disabled:!(r.name&&r.name.trim()!==""&&r.value!==null),icon:"pi pi-plus","aria-label":`add ${a.category}`,onClick:u[0]||(u[0]=i=>{var d;return(d=e.value)==null?void 0:d[a.category].push({name:null,value:null})})},null,8,["disabled","aria-label"])):D("",!0)])}),128))])]}),_:1})}}}),ye={class:"flex gap-2 items-center"},we=N({__name:"RowSavings",props:{form:{},category:{}},setup(w){return(e,a)=>{const u=ne;return _(!0),x(F,null,U(e.form[e.category].filter(p=>p.name&&p.value!=null),(p,g)=>(_(),x("div",{key:e.category+"-"+g,class:"item rounded shadow-sm h-fit"},[v("div",ye,[f(u,{severity:e.category==="enters"?"success":"danger",value:e.category==="enters"?"Entrée":"Sortie"},null,8,["severity","value"]),v("p",null,R(p.name),1)]),v("p",null,R(p.value)+" €",1)]))),128)}}}),$e=({form:w})=>({months:W(()=>{const a=w.value.start,u=w.value.end;if(!a||!u)return[];const p=[],g=new Date(a.getFullYear(),a.getMonth(),1),o=new Date(u.getFullYear(),u.getMonth(),1);for(;g<=o;)p.push(g.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})),g.setMonth(g.getMonth()+1);return p})}),he=({form:w,months:e,savings:a})=>{const u=({category:o})=>w[o].filter(m=>m.name&&m.value!=null).map(m=>{const t={Type:o==="enters"?"Entrée":"Sortie",Nom:m.name};return e.forEach(r=>{t[r]=m.value}),t}),p=({worksheet:o,enterEndRow:s,summaryStartRow:m,categoryItems:t,categoryType:r})=>{const $=`C2:C${s}`,i=o.getRow(m);i.getCell(1).value=`Total ${r==="enters"?"Entrées":"Sorties"}`,i.getCell(3).value={formula:`SUM(${$})`,result:t.reduce((d,y)=>d+y[e[0]],0)}};return{exportFormToExcel:async()=>{try{const[o,s]=await Promise.all([I(()=>import("./DigIgAcp.js").then(l=>l.e),__vite__mapDeps([0,1]),import.meta.url),I(()=>import("./CshrRwMP.js").then(l=>l.F),__vite__mapDeps([2,1]),import.meta.url)]),m=new o.default.Workbook,t=m.addWorksheet("Budget");t.columns=[{header:"Type",key:"Type",width:15},{header:"Nom",key:"Nom",width:30},...e.map(l=>({header:l,key:l,width:18}))];const r=u({category:"enters"}),c=u({category:"exits"}),$=[...r,...c];t.addRows($);const i=1+r.length,d=1+r.length+c.length,y=d+1,L={Type:"Total",Nom:"Épargne Cumulative"};e.forEach((l,n)=>{const C=String.fromCharCode(67+n),A=`${C}2:${C}${i}`,P=`${C}${i+1}:${C}${d}`;let k,M;if(n===0)k=`SUM(${A})-SUM(${P})`,M=a[n];else{const X=String.fromCharCode(67+n-1);k=`SUM(${A})-SUM(${P})+${X}${y}`,M=a[n]+(a[n-1]||0)}L[l]={formula:k,result:M}}),t.addRow(L),t.addRow([]);const E=y+2;p({worksheet:t,enterEndRow:i,summaryStartRow:E,categoryItems:r,categoryType:"enters"}),p({worksheet:t,enterEndRow:i+1,summaryStartRow:E+1,categoryItems:c,categoryType:"exits"});const S="C",Y=`${S}2:${S}${i}`,G=`${S}${i+1}:${S}${d}`,B=t.getRow(E+2);B.getCell(1).value="Épargne Mensuelle",B.getCell(3).value={formula:`SUM(${Y})-SUM(${G})`,result:a[0]};const V=t.getRow(1);V.font={bold:!0,size:12},V.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD3D3D3"}},V.alignment={horizontal:"center",vertical:"middle"};for(let l=2;l<=i;l++){const n=t.getRow(l);n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE8F5E8"}},n.getCell(1).font={bold:!0}}for(let l=i+1;l<=d;l++){const n=t.getRow(l);n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFCE8E8"}},n.getCell(1).font={bold:!0}}const z=t.getRow(y);z.font={bold:!0,size:12},z.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFF2CC"}};for(let l=E;l<=E+2;l++){const n=t.getRow(l);n.getCell(1).font={bold:!0},n.getCell(2).font={bold:!0}}const H=2+e.length,K=E+2;for(let l=2;l<=K;l++)for(let n=3;n<=H;n++){const C=t.getCell(l,n);C.numFmt="#,##0.00",C.alignment={horizontal:"right"}}const q=await m.xlsx.writeBuffer(),Q=new Blob([q],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});s.saveAs(Q,"budget-avec-formules.xlsx")}catch(o){console.error("Error exporting to Excel:",o)}}}},xe={class:"flex gap-8 mt-6 w-full md:max-w-3/4"},Ce={class:"flex flex-col lg:flex-row gap-10 mt-6"},Ee={key:0,class:"flex justify-end mt-14"},be={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3"},Re={key:0,class:"mt-4 text-center font-bold text-xl"},it=N({__name:"index",setup(w){ce({title:"Prévision d’épargne mois par mois",description:"Estimez facilement votre épargne potentielle en entrant vos revenus et dépenses. Visualisez un tableau mois par mois pour mieux gérer votre budget.",ogTitle:"Prévision d’épargne mois par mois",ogDescription:"Visualisez votre épargne potentielle mois par mois avec Monea. Entrez vos revenus et dépenses pour un meilleur suivi de votre budget."});const e=ae({start:void 0,end:void 0,enters:[{name:null,value:null}],exits:[{name:null,value:null}]}),{months:a}=$e({form:e}),u=W(()=>{if(!(e.value.enters.some(s=>s.name&&s.value!=null)||e.value.exits.some(s=>s.name&&s.value!=null)))return[];const o=[];for(let s=0;s<a.value.length;s++){let m=0,t=0;e.value.enters.forEach(c=>{c.value!=null&&(m+=c.value)}),e.value.exits.forEach(c=>{c.value!=null&&(t+=c.value)});const r=o[o.length-1]||0;o.push(m-t+r)}return o}),{exportFormToExcel:p}=he({form:e.value,months:a.value,savings:u.value});return(g,o)=>{const s=_e,m=J,t=me,r=we,c=ue,$=ie,i=se;return _(),x(F,null,[v("div",xe,[f(b(j),{modelValue:e.value.start,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value.start=d),"date-format":"dd/mm/yy","show-icon":"",fluid:"",class:"w-full","icon-display":"input",placeholder:"Date de début"},null,8,["modelValue"]),f(b(j),{modelValue:e.value.end,"onUpdate:modelValue":o[1]||(o[1]=d=>e.value.end=d),"date-format":"dd/mm/yy","show-icon":"",fluid:"",class:"w-full","icon-display":"input",placeholder:"Date de fin"},null,8,["modelValue"])]),v("div",Ce,[f(s,{form:e.value,category:"enters"},null,8,["form"]),f(s,{form:e.value,category:"exits"},null,8,["form"])]),b(a).length>0?(_(),x("div",Ee,[f(m,{icon:"pi pi-file-export",label:"Exporter via Excel",onClick:o[2]||(o[2]=async()=>await b(p)())})])):D("",!0),f(i,{value:0,class:"shadow-sm mt-3"},{default:h(()=>[(_(!0),x(F,null,U(b(a),(d,y)=>(_(),T($,{key:y,value:y},{default:h(()=>[f(t,null,{default:h(()=>[O(R(d),1)]),_:2},1024),f(c,null,{default:h(()=>[v("div",be,[f(r,{category:"enters",form:e.value},null,8,["form"]),f(r,{category:"exits",form:e.value},null,8,["form"])]),isNaN(u.value[y])?D("",!0):(_(),x("p",Re," Epargne : "+R(u.value[y])+" € ",1))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})],64)}}});export{it as default};
